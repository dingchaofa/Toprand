/**
 * Created by admin on 2017/10/10.
 */

//第一场景图片预加载
var fir_scene_img = ['images/fir_scene/fir_scene_00001.jpg','images/fir_scene/fir_scene_00002.jpg','images/fir_scene/fir_scene_00003.jpg','images/fir_scene/fir_scene_00004.jpg','images/fir_scene/fir_scene_00005.jpg','images/fir_scene/fir_scene_00006.jpg','images/fir_scene/fir_scene_00007.jpg']

//第二场景图片预加载
var sec_scene_img = ['images/sec_scene/sec_scene_00001.png','images/sec_scene/sec_scene_00002.png','images/sec_scene/sec_scene_00003.png','images/sec_scene/sec_scene_00004.png','images/sec_scene/sec_scene_00005.png','images/sec_scene/sec_scene_00006.png']

//第三场景
var thi_scene_img = ['images/thi_scene/five_scene_01.jpg','images/thi_scene/five_scene_02.jpg','images/thi_scene/five_scene_03.jpg','images/thi_scene/five_scene_04.jpg','images/thi_scene/five_scene_05.jpg','images/thi_scene/five_scene_06.jpg','images/thi_scene/five_scene_05.jpg']

//第四场景
var fou_scene_img = ['images/fou_scene/fou_scene_01.jpg','images/fou_scene/fou_scene_02.jpg','images/fou_scene/fou_scene_03.jpg','images/fou_scene/fou_scene_04.jpg','images/fou_scene/fou_scene_05.jpg','images/fou_scene/fou_scene_06.jpg','images/fou_scene/fou_scene_07.jpg','images/fou_scene/fou_scene_08.jpg']

//第五场景
var fif_scene_img = ['images/fif_scene/fif_scene_01.jpg','images/fif_scene/fif_scene_02.jpg','images/fif_scene/fif_scene_03.jpg','images/fif_scene/fif_scene_04.jpg','images/fif_scene/fif_scene_05.jpg']

//第六场景
var six_scene_img = ['images/six_scene/six_scene_01.jpg','images/six_scene/six_scene_02.jpg','images/six_scene/six_scene_03.jpg','images/six_scene/six_scene_04.jpg','images/six_scene/six_scene_05.jpg','images/six_scene/six_scene_06.jpg','images/six_scene/six_scene_07.jpg','images/six_scene/six_scene_08.jpg']

//第七场景
var sev_scene_img = ['images/sev_scene/sev_scene_01.jpg','images/sev_scene/sev_scene_02.jpg','images/sev_scene/sev_scene_03.jpg','images/sev_scene/sev_scene_04.jpg','images/sev_scene/sev_scene_05.jpg','images/sev_scene/sev_scene_06.jpg','images/sev_scene/sev_scene_07.jpg','images/sev_scene/sev_scene_08.jpg']

//第八场景
var eig_scene_img = ['images/eig_scene/eig_scene_01.jpg','images/eig_scene/eig_scene_02.jpg','images/eig_scene/eig_scene_03.jpg','images/eig_scene/eig_scene_04.jpg','images/eig_scene/eig_scene_03.jpg','images/eig_scene/eig_scene_02.jpg']

//第九场景 循环
var nin_scene_img0 = ['images/nin_scene/nin_scene_01.jpg','images/nin_scene/nin_scene_02.jpg','images/nin_scene/nin_scene_03.jpg','images/nin_scene/nin_scene_04.jpg','images/nin_scene/nin_scene_05.jpg','images/nin_scene/nin_scene_04.jpg','images/nin_scene/nin_scene_03.jpg','images/nin_scene/nin_scene_02.jpg']

//第九场景 不循环
var nin_scene_img1 = ['images/nin_scene/nin_scene_11.png','images/nin_scene/nin_scene_12.png','images/nin_scene/nin_scene_13.png','images/nin_scene/nin_scene_14.png','images/nin_scene/nin_scene_15.png','images/nin_scene/nin_scene_16.png','images/nin_scene/nin_scene_17.png','images/nin_scene/nin_scene_18.png']

//第十场景，循环风景
var ten_scene_img0 = ['images/ten_scene/ten_scene_01.jpg','images/ten_scene/ten_scene_02.jpg','images/ten_scene/ten_scene_03.jpg','images/ten_scene/ten_scene_04.jpg','images/ten_scene/ten_scene_05.jpg','images/ten_scene/ten_scene_06.jpg','images/ten_scene/ten_scene_07.jpg','images/ten_scene/ten_scene_08.jpg']

//第十场景，人物单执行
var ten_scene_img1 = ['images/ten_scene/ten_scene_11.png','images/ten_scene/ten_scene_12.png','images/ten_scene/ten_scene_13.png','images/ten_scene/ten_scene_14.png','images/ten_scene/ten_scene_15.png','images/ten_scene/ten_scene_16.png','images/ten_scene/ten_scene_17.png','images/ten_scene/ten_scene_18.png']

//第十一场景，循环风景
var ele_scene_img0 = ['images/ele_scene/ele_scene_11.jpg','images/ele_scene/ele_scene_12.jpg','images/ele_scene/ele_scene_13.jpg','images/ele_scene/ele_scene_14.jpg','images/ele_scene/ele_scene_15.jpg','images/ele_scene/ele_scene_16.jpg','images/ele_scene/ele_scene_17.jpg','images/ele_scene/ele_scene_18.jpg']

//第十一场景，人物单执行
var ele_scene_img1 = ['images/ele_scene/ele_scene_01.png','images/ele_scene/ele_scene_02.png','images/ele_scene/ele_scene_03.png','images/ele_scene/ele_scene_04.png','images/ele_scene/ele_scene_05.png','images/ele_scene/ele_scene_06.png','images/ele_scene/ele_scene_07.png','images/ele_scene/ele_scene_08.png']

//第十二场景
var twe_scene_img = ['images/twe_scene/twe_scene_01.jpg','images/twe_scene/twe_scene_02.jpg','images/twe_scene/twe_scene_03.jpg','images/twe_scene/twe_scene_04.jpg','images/twe_scene/twe_scene_05.jpg','images/twe_scene/twe_scene_06.jpg','images/twe_scene/twe_scene_07.jpg','images/twe_scene/twe_scene_08.jpg']

//第十三场景
var thith_scene_img = ['images/thith_scene/thith_scene_01.jpg','images/thith_scene/thith_scene_02.jpg','images/thith_scene/thith_scene_03.jpg','images/thith_scene/thith_scene_04.jpg','images/thith_scene/thith_scene_05.jpg','images/thith_scene/thith_scene_06.jpg','images/thith_scene/thith_scene_07.jpg','images/thith_scene/thith_scene_08.jpg']

//第十五场景 循环
var fifth_scene_img = ['images/fifth_scene/fifth_scene_01.jpg','images/fifth_scene/fifth_scene_02.jpg','images/fifth_scene/fifth_scene_03.jpg','images/fifth_scene/fifth_scene_04.jpg','images/fifth_scene/fifth_scene_05.jpg','images/fifth_scene/fifth_scene_04.jpg','images/fifth_scene/fifth_scene_03.jpg','images/fifth_scene/fifth_scene_02.jpg']

//非序列帧图片预加载
var no_keyframe = ['images/fir_scene/black_city.jpg','images/fir_scene/light_city.jpg','images/lantern.png','images/sec_scene/sec_scene.jpg','images/fif_scene/fif_dct_01.png','images/fif_scene/fif_dct_02.png','images/fif_scene/fif_dct_03.png','images/fourth_scene/fourth_scene.jpg','images/fourth_scene/fourth_scene.png','images/fifth_scene/fifth_scene.png','images/fourth_scene/inner1.png','images/fourth_scene/inner2.png','images/fourth_scene/inner3.png']

var loaded_img = []

var all_scene_img = no_keyframe.concat(fir_scene_img,sec_scene_img,thi_scene_img,fou_scene_img,fif_scene_img,six_scene_img,sev_scene_img,eig_scene_img,nin_scene_img0,nin_scene_img1,ten_scene_img0,ten_scene_img1,ele_scene_img0,ele_scene_img1,twe_scene_img,thith_scene_img,fifth_scene_img)

var load_percent = document.getElementsByClassName('load_percent')[0],
    text_hint = document.getElementsByClassName('text_hint')[0],
    audio = document.querySelector('audio'),
    music_icon = document.querySelector('.arrow+img ')

function preloadImg() {
  var loader = new PxLoader()
  all_scene_img.forEach(function (ele) {
    var this_img = new PxLoaderImage(ele)
    loaded_img.push(this_img) //保存加载过的图片，防止重复请求
    loader.add(this_img)
  })
  loader.addProgressListener(function (e) {
    var percent = parseInt((e.completedCount/e.totalCount)*100)
    load_percent.style.left = '230px'
    load_percent.textContent = percent +'%'
    //console.log(percent)
  })
  loader.addCompletionListener(function () {
    music_icon.classList.add('music_rotate')
    setTimeout(function () {
      text_hint.style.left = '66px'
      text_hint.textContent = '点击屏幕让树苗生长'
    },500)
    audio.play()
  })
  loader.start()
}
preloadImg()

music_icon.addEventListener('touchstart',function () {
  if(audio.paused){
    music_icon.classList.add('music_rotate')
    audio.play()
  }else{
    music_icon.classList.remove('music_rotate')
    audio.pause()
  }
})